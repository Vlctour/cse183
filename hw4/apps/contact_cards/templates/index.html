[[extend 'layout.html']]

<style>
[v-cloak] {
     display: none;
}
</style>


<div class="section" id="app" v-cloak>
    <!-- Put here your Vue.js template -->
    <div class="container">
        <h1 class="title">Contacts</h1>
        <div><button class="button is-success" id="add_button" @click="add_contact">Add Contact</button></div>
        <div class="card contact mt-4" v-for="contact in contacts">
            <div class="card-content">
                <div class="media">
                    <div class="media-left">
                        <figure class="photo image is-96x96 is-clickable" @click="click_figure(contact.id)">
                            <img class="photo" :src="contact.contact_image"/>
                            <input :id="'file-input' + contact.id" type="file" style="display: none"
                            accept=".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|image/*"
                            @change="select_file($event, contact.id)"
                            >
                        </figure>
                    </div>
                    <div class="media-content">
                        <p class="title person-name">
                        <input type="text" class="input is-4 title" 
                            name="name"
                            placeholder="Name"
                            v-model="contact.contact_name"
                            :readonly="!contact.editable_name"
                            @click="toggle_edit(contact.id, 'name')"
                            @blur="update_contact(contact.id, 'contact_name')"
                        />
                        </p>
                        <p class="subtitle person-affiliation">
                        <input type="text" class="input is-6" 
                            name="affiliation"
                            placeholder="Affiliation"
                            v-model="contact.contact_affiliation"
                            :readonly="!contact.editable_aff"
                            @click="toggle_edit(contact.id, 'aff')"
                            @blur="update_contact(contact.id, 'contact_affiliation')"
                        />
                        </p>
                    </div>
                    <div class="media-right">
                        <i class="delete-button 
                        has-text-danger 
                        fa-solid 
                        fa-trash-can 
                        trash
                        is-clickable"
                        @click="del_contact(contact.id)"
                        ></i>
                    </div>
                </div>
                <textarea class="textarea"
                    name="description"
                    placeholder="Description"
                    v-model="contact.contact_description"
                    :readonly="!contact.editable_desc"
                    @click="toggle_edit(contact.id, 'desc')"
                    @blur="update_contact(contact.id, 'contact_description')"
                ></textarea> 
            </div>
        </div>
    </div>
</div>
<!-- </div> -->


[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
    let get_contacts_url = "[[=XML(get_contacts_url)]]";
    let add_contacts_url = "[[=XML(add_contacts_url)]]";
    let update_contacts_url = "[[=XML(update_contacts_url)]]";
    let file_upload_url = "[[=XML(file_upload_url)]]";
    let del_contacts_url = "[[=XML(del_contacts_url)]]";
    // Add more URLs if you wish. 
</script>

<script src="js/index.js"></script>
[[end]]
