[[extend 'layout.html']]

<style>
[v-cloak] {
    display: none;
}
</style>

<div class="section" id="app" v-cloak>
<!-- Complete.  -->
    <div class="container">
        <div class="columns">
            <div class="column is-three-quarters">
                <textarea class="textarea" id="post-input" v-model="new_post"></textarea>
                <button id="post-button" class="button is-success mt-2 mb-6" @click="add_post">Post</button>
                <div class="box media post" v-for="(post, index) in posts">
                    <div class="media-content">
                        <p class="post-content">{{ post.post }}</p>
                        <p class="idk yet">posted on {{ post.date_time }} by user {{ post.user_email }}</p>
                    </div>
                    <div class="media-right">
                        <button v-if="deletable[index]" class="button is-danger delete-button" @click="delete_post(post.id)">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="column is-one-quarter">
                <h4 class="subtitle is-4">Tags</h4>
                <div class="buttons tags">
                    <button
                    class="button tag"
                    :class="{'is-success': tags_selected[index]}"
                    v-for="(tag, index) in tags"
                    @click="filter_tag(tag.tag)"
                    >
                        <p>{{tag.tag}}</p>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

[[block page_scripts]]
<script>
  // Complete.
  let get_posts_url = "[[=XML(get_posts_url)]]";
  let get_tags_url = "[[=XML(get_tags_url)]]";
  let add_post_url = "[[=XML(add_post_url)]]";
  let delete_post_url = "[[=XML(delete_post_url)]]";
</script>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"></script>
<script src="[[=URL('static/js/index.js')]]"></script>
[[end]]
